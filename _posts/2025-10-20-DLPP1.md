---
title: "딥러닝 파이썬 패키지 (1)"
description: "딥러닝의 기초가 되는 데이터 분석 라이브러리 : Pandas, NumPy, Matplotlib 개요와 활용 방법을 정리한 노트 - (상)"
author: Seunga Kim
date: 2025-10-20
categories: [Python]
tags: [Deep Learning, Data Analysis]
image: /assets/img/dl.png
toc: true
toc_label: "Table of Contents"
comments: false
---
# 딥러닝 파이썬 패키지 (1)

> 주요 데이터 분석 및 시각화 라이브러리 Part.1
> pandas · numpy · matplotlib


## 1. Pandas 개요 및 활용

> 데이터 **분석(Analysis)** 과 **조작 및 처리** 를 위한 Python 라이브러리

### 1-1. 개요
- CSV, Excel 등 다양한 데이터 파일을 읽고 가공
- 데이터 필터링, 정렬, 그룹화, 통계 계산 등 가능

### 자료구조 : (1) Series, (2) DataFrame

#### Series?
- **1차원(1D)** 데이터 구조  
- **라벨(index)** 이 있는 데이터 집합
- 따로 라벨 지정해주지 않으면 0부터 인덱싱 해버림
- 예: `pd.Series([101, 102, 103])`

##### Series 생성 방법
1. 리스트 기반으로 생성  
2. 딕셔너리 기반으로 생성 (key → index 로 자동 변환)

```python
import pandas as pd
# 1. 리스트 기반
s1 = pd.Series([101, 102, 103], index=['a', 'b', 'c'])
# 2. 딕셔너리 기반
s2 = pd.Series({'a': 101, 'b': 102, 'c': 103})
```
#### DataFrame?
- **2차원(2D)** 면 형식의 데이터 구조 (row·col)
- 라벨이 있는 행과 열을 가짐
- **엑셀 형태의 표 데이터**를 다룰 때 사용

##### DataFrame 생성 방법
1. 중첩 리스트 기반으로 생성  
2. 딕셔너리 기반으로 생성 (key → name of column 로 자동 변환)

```python
# 1. 중첩 리스트
data = [[1, 'Apple', 3000],
        [2, 'Banana', 1400],
        [3, 'Cherry', 4200]]
df_fruits = pd.DataFrame(data, columns=['id', 'fruit', 'price'])

# 2. 딕셔너리
data = {'student': ['Kim', 'Lee', 'Park', 'Choi'],
        'math_score': [88, 92, 75, 85],
        'english_score': [90, 85, 78, 95]}
df = pd.DataFrame(data)
```
```python
# ouput 1
   id   fruit  price
0   1   Apple   3000
1   2  Banana   1400
2   3  Cherry   4200

# output 2
  student  math_score  english_score
0     Kim          88             90
1     Lee          92             85
2    Park          75             78
3    Choi          85             95
# 따로 라벨 지정해주지 않으면 0부터 인덱싱 해버림
```
### 1-2. 활용
#### 1-2-1. 파일 읽기 
    1. CSV 형식 : pd.read_csv()
    2. Excel 형식 : pd.read_excel() (모듈 필수: openpyxl)
#### 1-2-2. 데이터 탐색
```python
    data = pd.read_csv()
    df = pd.DataFrame()
```
1. data.head()
    - show top 5 rows only
2. data.tail()
    - show last 5 rows only
3. df.info()
    - summary : dtype(DataFrame), num of data, memory usage...
4. df.describe()
    - count, mean, standard deviation, min, 25%, 50%, 75%, 100%(max)...

#### 1-2-3. 데이터 샘플링
- 전체 데이터 중 랜덤으로 샘플 데이터 뽑아서 가져와
```python
    df = pd.DataFrame
```
1. df.sample(2)
    - randomly select **2 rows** from DataFrame
2. df.sample(frac = 0.5)    # 50%
    - **frac** stands for fraction
    - randomly samples **certain percentage** of the total data

#### 1-2-4. 데이터 조작
1. 선택 및 필터링
    - 특정 열이나 행 선택 -> 열 또는 행의 이름 이용
    - **조건에 맞는** 데이터만 필터링 가능
        ```python
        # 열 선택
        df['math_score']

        # 멀티 열 선택
        df[['student', 'math_score']]

        # 조건 필터링 (math_score 80 이상만)
        df[df['math_score'] >= 80]
        ```
2. 정렬
    - 특정 열 또는 인덱스를 기준으로 정렬
        ```python
        df.sort_values(by= 'math_score', ascending= False)
        # discending order
        ```
3. 추가
    - 새로운 행 또는 열 추가
        ```python
        # new row (1)
        new_row = {'student': 'Han', 'math_score': 95, 'english_score': 88}
        df = pd.concat([df, pd.DataFrame([new_row])], ignore_index=True)

        # new row (2)
        df.loc['d'] = ['Cha', 'math_score': 100, 'english_score': 98]
        # row 의 인덱스 이름 & 정수 위치로 접근
        # .loc() = label-based indexer -> index label 기준 접근
        # .iloc[] = integer location -> int position 기준 접근

        # new col
        df['total'] = df['math_score'] + df['english_score']
        ```
4. 삭제
    - 행 또는 열을 제거
        > inplace = True : 원본 df 수정
        > inplace = False : 원본 df 유지, 열 또는 행 삭제된 새로운 df 생성 및 반환
        
        ```python
        # 열 삭제
        df.drop(columns=['total'], inplace=True)

        # 행 삭제 (index 0번 제거)
        df.drop(index=0, inplace=True)
        ```
5. 두개의 다른 데이터 연결 `Concatenation`
    - DataFrame 행(row wise) 기준으로 연결
    - concat(df_list) : **list 형식**이 파라미터로 입력됨 `[df, df2]`
        ```python
            import pandas as pd

            df1 = pd.DataFrame({'A': [1, 2], 'B': [3, 4]})
            df2 = pd.DataFrame({'A': [5, 6], 'B': [7, 8]})

            # 행 방향 연결 (위아래로)
            df_row = pd.concat([df1, df2], axis=0) # 리스트 형식!
            print(df_row)
            '''
               A  B
            0  1  3
            1  2  4
            0  5  7
            1  6  8
            '''

            # index 꼬였으면 초기화 
            # (1) reset() : 0 부터 시작하는 새 정수 인덱스 생성
            reseted = concated.reset_index(drop=True)
            # drop = True : 기존의 인덱스 열을 버림

            # (2) index 초기화 
            df_row = pd.concat([df1, df2], axis=0, ignore_index=True)   # 인덱스 새로 지정
        ```

6. 두개의 다른 데이터 병합 `Merge`
    - DataFrame 열(key) 기준으로 df 결합
    - SQL 의 `JOIN` 이랑 비슷
        ```python
            import pandas as pd

            left = pd.DataFrame({'id': [1, 2, 3],
                                'name': ['A', 'B', 'C']})

            right = pd.DataFrame({'id': [1, 2, 4],
                                    'score': [90, 80, 70]})

            # 내부 조인 (inner join) -> 진짜 JOIN(SQL)
            df_inner = pd.merge(left, right, on='id', how='inner')

            # 외부 조인 (outer join)
            df_outer = pd.merge(left, right, on='id', how='outer')

        '''
        (1) INNER JOIN
            id name  score
        0   1    A     90
        1   2    B     80

        (2) OUTER JOIN
            id name  score
        0   1    A   90.0
        1   2    B   80.0
        2   3    C    NaN
        3   4  NaN   70.0
        '''
        ```

#### 1-2-5. 데이터 처리
1. 결측치 처리
    - NaN(Not a Number) : NA, None, null
    (1) 확인 : isnull()
    (2) 결측치 채우기 : fillna()

        ```python
            import pandas as pd
            import numpy as np

            df = pd.DataFrame({'name': ['Kim', 'Lee', 'Park', 'Choi'],
                                'score': [85, np.nan, 90, np.nan]})

            # (1) 결측치 확인
            print(df.isnull())

            # (2) 결측치 개수 확인
            print(df.isnull().sum())

            # (3) 결측치 채우기 : 평균값으로
            df['score'].fillna(df['score'].mean(), inplace=True)
            print(df)

            '''
                name  score
            0    Kim   85.0
            1    Lee   87.5
            2   Park   90.0
            3   Choi   87.5
            '''
        ```

2. 중복 데이터 처리
    - 동일한 행이 여러 번 등장하면 중복으로 간주
    (1) 확인 : duplicated() -> T/F
    (2) 제거 :drop_duplicates()

        ```python
            df = pd.DataFrame({ 'name': ['Kim', 'Lee', 'Park', 'Lee'],
                                'score': [90, 85, 80, 85]})

            # (1) 중복 확인 -> Lee 가 중복
            print(df.duplicated())

            # (2) 중복 제거
            df.drop_duplicates(inplace=True)
            print(df)
        '''
           name  score
        0   Kim     90
        1   Lee     85
        2  Park     80
        '''
        ```

---

## 2. Numpy 개요 및 활용

> **다차원 배열 및 행렬 연산** 등 고성능 수치 계산 (Numerical Python) 을 위한 다양한 함수를 제공하는 라이브러리.

### 2-1. 개요
#### 주요 특징
- 빠르고 효율적인 배열 연산 (ndarray) 지원
- 브로드캐스팅, 선형대수, 통계, 난수 생성 등 제공함
- 딥러닝 프레임워크 (PyTorch, TensorFlow) 의 기반!

    ```python
    import numpy as np

    # 제발 그만 깜박해.. 2d list -> [[]] 한번 더 감싸야 함! 리스트 안에 리스트!!
    arr = np.array([[1, 2, 3], [4, 5, 6]])
    print(arr.shape)    # (2, 3) -> 2x3 matrix
    print(arr.dtype)    # 데이터 타입 (예: int64)
    print(arr.ndim)     # 차원 수 (예: 2)
    type(arr)           # <class 'numpy.ndarray>
    # d : dimension
    # ndarray : n-dimension array
    ```
    - `(5,)` : 1 차원 데이터가 5개 있다
    - `(n, m)` : 2 차원
    - `(x, y, z)` : 3 차원

#### numpy 생성 및 초기화
1. 0 으로 초기화
2. 1 로 초기화
3. 특정 값으로 초기화
4. identity matrix (단위 행렬)
    - eye() : 좌우가 대칭이라 identity 
    - identity()
5. random matrix (난수 배열 & 정수 난수 배열)
    - **random float matrix**
        - np.random.rand(n, m)  
            - random 한 수 n x m 로 생성
            - range : 0 이상 1 미만의 float 배열의 원소
            - 예 : `[[0.3254 0.8127 0.1269],
                    [0.5821 0.9425 0.7310]]`

    - **random integer matrix**
        - np.random.randint(a, b, (n, m))
            - nxm
            - range : a 이상 b 미만 정수가 배열의 원소
            - 예 : `[[1, 2 ], [7, 9]]`

    ```python
        import numpy as np

        # 1. 0으로 초기화
        a = np.zeros((2, 3))

        # 2. 1로 초기화
        b = np.ones((2, 2))

        # 3. 특정 값으로 초기화
        c = np.full((2, 2), 7)

        # 4. 단위 행렬 (Identity matrix)
        d = np.eye(3)

        # 5. 난수 배열 (Random matrix)
        e = np.random.rand(2, 3)
    ```

### 2-2. 활용 (배열 연산)
#### 2-2-1. 배열 연산
##### 1. 기본 산술
- 요소별 연산 : 배열간 연산은 element-wise
    ```python
        x = np.array([1, 2, 3])
        y = np.array([4, 5, 6])

        print(x + y)   # [5 7 9]
        print(x * y)   # [4 10 18]
        print(x ** 2)  # [1 4 9]
    ```

##### 2. 통계 함수
- sum
- mean
- max & min
    ```python
        arr = np.array([10, 20, 30, 40, 50])

        print(arr.sum())   # 합계
        print(arr.mean())  # 평균
        print(arr.max())   # 최대값
        print(arr.min())   # 최소값
        print(arr.std())   # 표준편차
    ```
##### 3. 브로드 캐스팅
- **서로 다른 크기:shape** 의 배열 간 연산을 numpy 가 **자동으로 형태를 확장**하여 연산 수행
    ```python
        arr = np.array([[1, 2, 3], [4, 5, 6]])
        num = 10
        print(arr + num)

        '''
        [[1, 2, 3],      [[10, 10, 10],
        [4, 5, 6]]   +   [10, 10, 10]]
        --------------------------------
        [[11 12 13]
        [14 15 16]]
        '''
    ```
##### 4. 선형 대수 연산
- 행렬 곱:
    ```python 
        A = np.array([[1, 2], [3, 4]])
        B = np.array([[5, 6], [7, 8]])

        # 행렬 곱 (dot product(i * j) in 2d)
        print(np.dot(A, B))  
    ```

#### 2-2-2. 배열 인덱싱 및 슬라이싱
1. 인덱싱
- 1차원 배열: 
    ```python
    arr = [1, 2, 3, 4, 5]
    arr[:-1]    # [1, 2, 3, 4]
    ```
- 다차원 배열:
    ```python
        arr = np.array([[10, 20, 30],
                        [40, 50, 60],
                        [70, 80, 90]])

        print(arr[0, 0])   # 10
        print(arr[1, 2])   # 60
    ```

2. 슬라이싱: 
    ```python
        print(arr[0:2, 1:3])  # [[20 30]
                              #  [50 60]]
    ```

#### 2-2-3. 조건 필터링
    ```python
        arr = np.array([10, 25, 30, 45, 50])
        print(arr[arr > 30])  # [45 50]
    ```

#### 2-2-4. Numpy와 Pandas 통합 사용
- Pandas DataFrame 으로 변환

    ```python
        import numpy as np
        import pandas as pd

        arr = np.random.randint(1, 10, (3, 3))
        df = pd.DataFrame(arr, columns=['A', 'B', 'C'])

        print(arr)
        print(df)
        '''
        [[4 9 1]
        [7 3 5]
        [2 8 6]]

        A  B  C
        0  4  9  1
        1  7  3  5
        2  2  8  6
        '''
    ```

---

## 3. Matplotlib 개요 및 활용
> 데이터를 시각화 (그래프) 그리는 용도의 대표적인 Python 라이브러리
> mat·plot·lib 뜻 = matrix + plot + library

### 주요 Python 시각화 라이브러리
1. Matplotlib - **기본** 그래프 도구
2. Seaborn  - Matplotlib 기반의 **고급 시각화** 그래프 도구

### 3-1. 개요
-  기본 사용법
    ```python
        import matplotlib.pyplot as plt

        x = [1, 2, 3, 4]
        y = [10, 20, 25, 30]

        plt.plot(x, y, marker='o')
        plt.title("Basic Line Plot")
        plt.xlabel(xlabel = "X")
        plt.ylabel(ylabel = "Y")
        plt.show()
    ```
### 3-2 주요 그래프 유형
1. 선 그래프 (Line Plot)
    - 시간의 흐름이나 추세 -trend- 시각화
        ```python
        plt.plot([1, 2, 3, 4], [10, 20, 25, 30], color='blue', marker='o')
        plt.title("Line Graph")
        plt.show()
        ```
2. 막대 그래프 (Bar Chart)
    - 범주형(라벨?) 데이터 간 비교용
        ```python
        fruits = ['Apple', 'Banana', 'Cherry']
        sales = [30, 45, 20]

        plt.bar(fruits, sales, color='orange')
        plt.title("Fruit Sales")
        plt.ylabel("Quantity")
        plt.show()
        ```
3. 히스토그램 (Histogram)
    - 데이터의 분포도 - distribution- 를 시각화
        ```python
        import numpy as np

        data = np.random.randn(1000)
        plt.hist(data, bins=30) 
        plt.title("Histogram")
        plt.xlabel(xlabel = "Value")
        plt.ylabel(ylabel = "Frequency")
        plt.show()
        ```
4. 산점도
    - 두 변수 간 관계를 시각화
        ```python
            x = np.random.rand(50)
            y = np.random.rand(50)

            plt.scatter(x, y, color='green')
            plt.title("Scatter Plot")
            plt.xlabel(xlabel = "X")
            plt.ylabel(ylabel = "Y")
            plt.show()
        ```
5. 파이 차트, 원 그래프
    ```python
        labels = ['A', 'B', 'C']
        sizes = [40, 35, 25]

        plt.pie(sizes, labels=labels, autopct='%1.1f%%', startangle=90)
        plt.title("Pie Chart Example")
        plt.show()
    ```
6. 박스 플롯
    - 데이터의 분산 - variability - 시각화, 특히나 4분위 데이터 (25, 50, 75, 100)
    ```python
        data = [np.random.normal(0, std, 100) for std in range(1, 4)]

        plt.boxplot(data, vert=True, patch_artist=True)
        plt.title("Box Plot")
        plt.xlabel("Groups")
        plt.ylabel("Values")
        plt.show()
    ```

### 3-3. 활용
- 그래프 커스터마이징
    ```python
        x = [1, 2, 3, 4, 5]
        y = [10, 12, 30, 25, 15]

        plt.plot(x, y, color= 'purple', linestyle= '--', marker= 's', linewidth=2)
        plt.title("Customized Graph")
        plt.xlabel("X values")
        plt.ylabel("Y values")
        plt.grid(True)
        plt.show()
    ```

- Subplot
    - DL 모델 그래프 accuracy, precision 등 학습 중 변화 뽑을 때 많이 사용
    ```python
        x = np.linspace(0, 10, 100)

        plt.figure(figsize=(8, 4))

        # 1행 2열 구조 중 첫 번째 그래프
        plt.subplot(1, 2, 1)
        plt.plot(x, np.sin(x))
        plt.title("Sine")

        # 두 번째 그래프
        plt.subplot(1, 2, 2)
        plt.plot(x, np.cos(x))
        plt.title("Cosine")

        plt.tight_layout()
        plt.show()
    ```

